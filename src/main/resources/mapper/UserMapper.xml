<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.blog.Mapper.UserMapper">
    <!-- 定义通用的 resultMap -->
    <resultMap id="userResultMap" type="com.example.blog.Entity.User">
        <id column="user_id" property="userid"/>
        <result column="username" property="username"/>
        <result column="password" property="password"/>
        <result column="role_id" property="roleid"/>
        <result column="full_name" property="fullname"/>
    </resultMap>

    <!-- 查询所有用户 -->
    <select id="getAllUsers" resultMap="userResultMap">
        SELECT * FROM `user`;
    </select>

    <!-- 根据用户名查询用户 -->
    <select id="getUserByUsername" parameterType="String" resultMap="userResultMap">
        SELECT * FROM `user` WHERE `username` = #{username};
    </select>
    <!-- 根据权限id查询角色 -->
    <select id="getRole" parameterType="Integer" resultType="String">
        SELECT role_name FROM `roles` WHERE role_id =#{roleid}
    </select>
    <!-- 根据 ID 查询用户 -->
    <select id="getUserById" parameterType="Integer" resultMap="userResultMap">
        SELECT * FROM `user` WHERE `user_id` = #{userid};
    </select>

    <!-- 登录验证 -->
    <select id="login" parameterType="map" resultMap="userResultMap">
        SELECT * FROM `user`
        WHERE `username` = #{username} AND `password` = #{password};
    </select>
</mapper>